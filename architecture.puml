@startuml
!theme toy
title Architecture – Projet "Site bande-annonce film"

actor "Client" as Client

cloud "Internet" as Internet
cloud "Cloudflare" as Cloudflare

node "Docker Host" {

  package "Accès & Reverse Proxy" #LightBlue {
    component "cloudflared" as Cloudflared
    component "Caddy\n(Public)" as CaddyPublic
    component "Caddy\n(Private)" as CaddyPrivate
    component "Tailscale\n(VPN)" as Tailscale
  }

  package "Application" #LightGreen {
    component "Front-end\n(Nginx)" as Front
    component "Back-end\n(Node / Express)" as API
    database "MongoDB" as DB
  }
}

' --- Accès public
Client --> Internet
Internet --> Cloudflare
Cloudflare --> Cloudflared : tunnel
Cloudflared --> CaddyPublic

' --- Reverse proxy interne
CaddyPublic --> CaddyPrivate
CaddyPrivate --> Front : pages web
CaddyPrivate --> API   : /api/*

' --- Base de données
API --> DB

' --- Accès privé
Client --> Tailscale : VPN
Tailscale --> CaddyPrivate

@enduml